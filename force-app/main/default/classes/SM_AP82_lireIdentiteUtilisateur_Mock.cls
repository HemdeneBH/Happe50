@isTest
/*Author:MHA
*Description: mock creation de la proposition commerciale
*CreatedDate: 08/03/2019
*LastModified: MHA 08/03/2019
*/
global class SM_AP82_lireIdentiteUtilisateur_Mock implements HttpCalloutMock {
	global HTTPResponse respond(HTTPRequest req) {
		HttpResponse res = new HttpResponse();
		res.setHeader('Content-Type', 'application/json');
		DOM.Document responseDoc = new DOM.Document();
		DOM.Document reqDoc = req.getBodyDocument();
		DOM.XmlNode rootNode = reqDoc.getRootElement();
		DOM.XmlNode reqBodyNode = rootNode.getChildElement('Body', 'http://schemas.xmlsoap.org/soap/envelope/');
		DOM.XmlNode[] methodNode = reqBodyNode.getChildElements();
		System.debug('@MHA method '+methodNode[0].getName());
		String expectedResult = '';
		if(methodNode[0].getName() == 'lireIdentiteUtilisateur'){
			expectedResult = '<?xml version=\'1.0\' encoding=\'UTF-8\'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><tns:lireIdentiteUtilisateurResponse xmlns:tns="http://gdfsuez/bef/calypso/identiteUtilisateur/v3"><lireIdentiteUtilisateurOutput><identiteUtilisateur><idUtilisateur /><nom /><uniteOrganisationnelle><idUniteOrganisationnelle>50092565</idUniteOrganisationnelle><numeroBPUniteOrganisationnelle>309231799</numeroBPUniteOrganisationnelle><numeroBPUtilisateur>157187</numeroBPUtilisateur><idPersonne>50094214</idPersonne><idPosition>50092566</idPosition></uniteOrganisationnelle></identiteUtilisateur></lireIdentiteUtilisateurOutput><messageRetours><retourTraitementMessage><source>Middleware Octopus</source><libelle>Traitement effectu√© sans erreur</libelle><type>Information</type><code>OCTOPUS_ LireIdentiteUtilisateur_01</code><timestamp>2020-04-01T14:54:27+01:00</timestamp></retourTraitementMessage></messageRetours></tns:lireIdentiteUtilisateurResponse></soapenv:Body></soapenv:Envelope>';
                }

		responseDoc.load(expectedResult);
		res.setBody(responseDoc.toXmlString());
		res.setStatusCode(200);
		return res;
		// Create response element from the autogenerated class.
		// Populate response element.
		// Add response element to the response parameter, as follows:
		//response.put('response_x', responseElement);
	}
}